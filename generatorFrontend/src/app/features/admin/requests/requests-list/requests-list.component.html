<section class="space-y-6">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <h1 class="text-2xl font-semibold text-text">{{ 'admin.requests.title' | t }}</h1>
    <input
      type="search"
      class="w-full max-w-xs rounded-soft border border-white/10 bg-surface/80 px-3 py-2 text-sm text-text"
      [placeholder]="'admin.requests.search' | t"
      [value]="searchTerm()"
      (input)="searchTerm.set($any($event.target).value)"
    />
  </div>

  <div class="flex items-center gap-3" *ngIf="(loading$ | async)">
    <mat-spinner diameter="28"></mat-spinner>
    <span class="text-sm text-muted">Loading requests...</span>
  </div>

  <div class="grid gap-4" *ngIf="filteredRequests().length > 0; else empty">
    <article *ngFor="let request of filteredRequests()" class="rounded-soft border border-white/10 bg-surface/95 p-4 shadow-soft">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div>
          <h2 class="text-lg font-semibold text-text">{{ request.applicantName }}</h2>
          <p class="text-xs text-muted">{{ request.applicantEmail }} Â· {{ request.applicantPhone }}</p>
        </div>
        <mat-chip [color]="request.status === 'PENDING' ? undefined : request.status === 'APPROVED' ? 'primary' : 'warn'" selected>
          {{ ('admin.requests.status.' + request.status.toLowerCase()) | t }}
        </mat-chip>
      </div>
      <div class="mt-4 grid gap-2 text-sm text-muted md:grid-cols-3">
        <div>
          <span class="font-semibold text-text">Generator</span>
          <p>{{ request.generatorName }}</p>
        </div>
        <div>
          <span class="font-semibold text-text">Created</span>
          <p>{{ request.createdAt | date: 'mediumDate' }}</p>
        </div>
        <div *ngIf="request.notes">
          <span class="font-semibold text-text">Notes</span>
          <p>{{ request.notes }}</p>
        </div>
      </div>
      <div class="mt-4 flex gap-3">
        <button mat-raised-button color="primary" (click)="approve(request)" [disabled]="request.status !== 'PENDING'">{{ 'admin.requests.approve' | t }}</button>
        <button mat-stroked-button color="warn" (click)="reject(request)" [disabled]="request.status !== 'PENDING'">{{ 'admin.requests.reject' | t }}</button>
      </div>
    </article>
  </div>

  <ng-template #empty>
    <div class="rounded-soft border border-white/10 bg-surface/90 px-4 py-6 text-center text-sm text-muted">
      {{ 'admin.requests.empty' | t }}
    </div>
  </ng-template>
</section>
